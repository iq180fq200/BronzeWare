{"version":3,"file":"echarts-extension-amap.js","sources":["../src/helper.js","../src/AMapCoordSys.js","../src/AMapModel.js","../src/AMapView.js","../src/index.js","../index.js"],"sourcesContent":["import { version } from 'echarts/lib/echarts'\n\nexport const isV5 = version.split('.')[0] > 4\n\n/* global AMap */\n\n// `AMap.version` only exists in AMap 2.x\n// For AMap 1.x, it's `AMap.v`\n// use function instead of constant to allow importing the plugin before AMap is loaded\nexport const isAMap2X = () => AMap.version >= 2\n\nexport function v2Equal(a, b) {\n  return a && b && a[0] === b[0] && a[1] === b[1]\n}\n\nlet logMap = {}\n\nexport function logWarn(tag, msg, once) {\n  const log = `[ECharts][Extension][AMap]${tag ? ' ' + tag + ':' : ''} ${msg}`\n  once && logMap[log] || console.warn(log)\n  once && (logMap[log] = true)\n}\n\nexport function clearLogMap() {\n  logMap = {}\n}\n","import { util as zrUtil, graphic, matrix } from 'echarts/lib/echarts'\nimport { logWarn } from './helper'\n\nfunction dataToCoordSize(dataSize, dataItem) {\n  dataItem = dataItem || [0, 0];\n  return zrUtil.map(\n    [0, 1],\n    function(dimIdx) {\n      const val = dataItem[dimIdx]\n      const halfSize = dataSize[dimIdx] / 2\n      const p1 = []\n      const p2 = []\n      p1[dimIdx] = val - halfSize\n      p2[dimIdx] = val + halfSize\n      p1[1 - dimIdx] = p2[1 - dimIdx] = dataItem[1 - dimIdx]\n      return Math.abs(\n        this.dataToPoint(p1)[dimIdx] - this.dataToPoint(p2)[dimIdx]\n      )\n    },\n    this\n  )\n}\n\n// exclude private and unsupported options\nconst excludedOptions = [\n  'echartsLayerZIndex', // DEPRECATED since v1.9.0\n  'echartsLayerInteractive',\n  'renderOnMoving',\n  'largeMode',\n  'returnMapCameraState',\n  'layers'\n]\n\nfunction AMapCoordSys(amap, api) {\n  this._amap = amap\n  this._api = api\n  this._mapOffset = [0, 0]\n  // this.dimensions = ['lng', 'lat']\n}\n\nconst AMapCoordSysProto = AMapCoordSys.prototype\n\nAMapCoordSysProto.setZoom = function(zoom) {\n  this._zoom = zoom\n}\n\nAMapCoordSysProto.setCenter = function(center) {\n  const lnglat = new AMap.LngLat(center[0], center[1])\n  this._center = this._amap.lngLatToContainer(lnglat)\n}\n\nAMapCoordSysProto.setMapOffset = function(mapOffset) {\n  this._mapOffset = mapOffset\n}\n\nAMapCoordSysProto.setAMap = function(amap) {\n  this._amap = amap\n}\n\nAMapCoordSysProto.getAMap = function() {\n  return this._amap\n}\n\nAMapCoordSysProto.dataToPoint = function(data) {\n  const lnglat = new AMap.LngLat(data[0], data[1])\n  const px = this._amap.lngLatToContainer(lnglat)\n  const mapOffset = this._mapOffset\n  return [px.x - mapOffset[0], px.y - mapOffset[1]]\n}\n\nAMapCoordSysProto.pointToData = function(pt) {\n  const mapOffset = this._mapOffset\n  const lnglat = this._amap.containerToLngLat(\n    new AMap.Pixel(\n      pt[0] + mapOffset[0],\n      pt[1] + mapOffset[1]\n    )\n  )\n  return [lnglat.lng, lnglat.lat]\n}\n\nAMapCoordSysProto.getViewRect = function() {\n  const api = this._api\n  return new graphic.BoundingRect(0, 0, api.getWidth(), api.getHeight())\n}\n\nAMapCoordSysProto.getRoamTransform = function() {\n  return matrix.create()\n}\n\nAMapCoordSysProto.prepareCustoms = function() {\n  const rect = this.getViewRect()\n  return {\n    coordSys: {\n      // The name exposed to user is always 'cartesian2d' but not 'grid'.\n      type: 'amap',\n      x: rect.x,\n      y: rect.y,\n      width: rect.width,\n      height: rect.height\n    },\n    api: {\n      coord: zrUtil.bind(this.dataToPoint, this),\n      size: zrUtil.bind(dataToCoordSize, this)\n    }\n  }\n}\n\nAMapCoordSys.create = function(ecModel, api) {\n  let amapCoordSys\n  ecModel.eachComponent('amap', function(amapModel) {\n    if (typeof AMap === 'undefined') {\n      throw new Error('AMap api is not loaded')\n    }\n    if (amapCoordSys) {\n      throw new Error('Only one amap component can exist')\n    }\n    let amap = amapModel.getAMap()\n    const echartsLayerInteractive = amapModel.get('echartsLayerInteractive')\n    if (!amap) {\n      const root = api.getDom()\n      const painter = api.getZr().painter\n      const viewportRoot = painter.getViewportRoot()\n      viewportRoot.className = 'amap-ec-layer'\n      // PENDING not hidden?\n      viewportRoot.style.visibility = 'hidden'\n      // Not support IE8\n      let amapRoot = root.querySelector('.ec-extension-amap')\n      if (amapRoot) {\n        // Reset viewport left and top, which will be changed\n        // in moving handler in AMapView\n        viewportRoot.style.left = '0px'\n        viewportRoot.style.top = '0px'\n        root.removeChild(amapRoot)\n      }\n      amapRoot = document.createElement('div')\n      amapRoot.className = 'ec-extension-amap'\n      amapRoot.style.cssText = 'position:absolute;top:0;left:0;bottom:0;right:0;'\n      root.appendChild(amapRoot)\n\n      const options = zrUtil.clone(amapModel.get())\n      if ('echartsLayerZIndex' in options) {\n        logWarn('DEPRECATED', 'the option `echartsLayerZIndex` has been removed since v1.9.0, use `echartsLayerInteractive` instead.')\n      }\n      // delete excluded options\n      zrUtil.each(excludedOptions, function(key) {\n        delete options[key]\n      })\n\n      amap = new AMap.Map(amapRoot, options)\n\n      // PENDING: should update the model option when the user call map.setXXX?\n\n      // const nativeSetMapStyle = amap.setMapStyle\n      // const nativeSetLang = amap.setLang\n\n      // // PENDING\n      // amap.setMapStyle = function () {\n      //   nativeSetMapStyle.apply(this, arguments)\n      //   amapModel.__mapStyle = amap.getMapStyle()\n      // }\n\n      // // PENDING\n      // nativeSetLang && (amap.setLang = function() {\n      //   nativeSetLang.apply(this, arguments)\n      //   amapModel.__mapLang = amap.getLang()\n      // })\n\n      // use `complete` callback to avoid NPE when first load amap\n      amap.on('complete', function() {\n        amapRoot.querySelector('.amap-maps').appendChild(viewportRoot)\n        // PENDING\n        viewportRoot.style.visibility = ''\n      })\n\n      amapModel.setAMap(amap)\n      amapModel.setEChartsLayer(viewportRoot)\n\n      // Override\n      painter.getViewportRootOffset = function() {\n        return { offsetLeft: 0, offsetTop: 0 }\n      }\n    }\n\n    const oldEChartsLayerInteractive = amapModel.__echartsLayerInteractive\n    if (oldEChartsLayerInteractive !== echartsLayerInteractive) {\n      amapModel.setEChartsLayerInteractive(echartsLayerInteractive)\n      amapModel.__echartsLayerInteractive = echartsLayerInteractive\n    }\n\n    const center = amapModel.get('center')\n    const zoom = amapModel.get('zoom')\n    if (center && zoom) {\n      const amapCenter = amap.getCenter()\n      const amapZoom = amap.getZoom()\n      const centerOrZoomChanged = amapModel.centerOrZoomChanged(\n        [amapCenter.lng, amapCenter.lat],\n        amapZoom\n      )\n      if (centerOrZoomChanged) {\n        amap.setZoomAndCenter(zoom, new AMap.LngLat(center[0], center[1]))\n      }\n    }\n\n    // update map style(#13)\n    const originalMapStyle = amapModel.__mapStyle\n    const newMapStyle = amapModel.get('mapStyle')\n    if (originalMapStyle !== newMapStyle) {\n      amap.setMapStyle(amapModel.__mapStyle = newMapStyle)\n    }\n\n    // update map lang\n    // PENDING: AMap 2.x does not support `setLang` yet\n    if (amap.setLang) {\n      const originalMapLang = amapModel.__mapLang\n      const newMapLang = amapModel.get('lang')\n      if (originalMapLang !== newMapLang) {\n        amap.setLang(amapModel.__mapLang = newMapLang)\n      }\n    }\n    else {\n      logWarn('CAVEAT', 'The current map doesn\\'t support `setLang` API!', true)\n    }\n\n    amapCoordSys = new AMapCoordSys(amap, api)\n    amapCoordSys.setMapOffset(amapModel.__mapOffset || [0, 0])\n    amapCoordSys.setZoom(zoom)\n    amapCoordSys.setCenter(center)\n\n    amapModel.coordinateSystem = amapCoordSys\n  })\n\n  ecModel.eachSeries(function(seriesModel) {\n    if (seriesModel.get('coordinateSystem') === 'amap') {\n      seriesModel.coordinateSystem = amapCoordSys\n    }\n  })\n}\n\nAMapCoordSysProto.dimensions = AMapCoordSys.dimensions = ['lng', 'lat']\n\nexport default AMapCoordSys\n","import { ComponentModel } from 'echarts/lib/echarts'\nimport { isV5, v2Equal } from './helper'\n\nconst AMapModel = {\n  type: 'amap',\n\n  setAMap(amap) {\n    this.__amap = amap\n  },\n\n  getAMap() {\n    return this.__amap\n  },\n\n  setEChartsLayer(layer) {\n    this.__echartsLayer = layer\n  },\n\n  getEChartsLayer() {\n    return this.__echartsLayer\n  },\n\n  setEChartsLayerVisiblity(visible) {\n    this.__echartsLayer.style.display = visible ? 'block' : 'none'\n  },\n\n  // FIXME: NOT SUPPORT <= IE 10\n  setEChartsLayerInteractive(interactive) {\n    this.option.echartsLayerInteractive = !!interactive\n    this.__echartsLayer.style.pointerEvents = interactive ? 'auto' : 'none'\n  },\n\n  setCenterAndZoom(center, zoom) {\n    this.option.center = center\n    this.option.zoom = zoom\n  },\n\n  centerOrZoomChanged(center, zoom) {\n    const option = this.option\n    return !(v2Equal(center, option.center) && zoom === option.zoom)\n  },\n\n  defaultOption: {\n    center: [116.397428, 39.90923],\n    zoom: 5,\n    isHotspot: false,\n    resizeEnable: true,\n\n    // extension specific options\n    // echartsLayerZIndex: 2000, // DEPRECATED since v1.9.0\n    echartsLayerInteractive: true,\n    renderOnMoving: true,\n    largeMode: false,\n    // since v1.10.0\n    returnMapCameraState: false\n  }\n}\n\nexport default isV5\n  ? ComponentModel.extend(AMapModel)\n  : AMapModel\n","import { ComponentView, getInstanceByDom, throttle } from 'echarts/lib/echarts'\nimport { isV5, isAMap2X, clearLogMap } from './helper'\n\nlet _isAMap2X\n\nconst AMapView = {\n  type: 'amap',\n\n  init() {\n    this._isFirstRender = true\n\n    _isAMap2X = isAMap2X()\n  },\n\n  render(amapModel, ecModel, api) {\n    let rendering = true\n\n    const amap = amapModel.getAMap()\n    const viewportRoot = api.getZr().painter.getViewportRoot()\n    const offsetEl = amap.getContainer()\n    const coordSys = amapModel.coordinateSystem\n\n    const renderOnMoving = amapModel.get('renderOnMoving')\n    const resizeEnable = amapModel.get('resizeEnable')\n    const largeMode = amapModel.get('largeMode')\n    const returnMapCameraState = amapModel.get('returnMapCameraState')\n\n    const viewMode = amap.getViewMode_()\n    const is3DMode = viewMode === '3D'\n\n    let moveHandler = function(e) {\n      if (rendering) {\n        return\n      }\n\n      const offsetElStyle = offsetEl.style\n      const mapOffset = [\n        -parseInt(offsetElStyle.left, 10) || 0,\n        -parseInt(offsetElStyle.top, 10) || 0\n      ]\n      // only update style when map offset changed\n      const viewportRootStyle = viewportRoot.style\n      const offsetLeft = mapOffset[0] + 'px'\n      const offsetTop = mapOffset[1] + 'px'\n      if (viewportRootStyle.left !== offsetLeft) {\n        viewportRootStyle.left = offsetLeft\n      }\n      if (viewportRootStyle.top !== offsetTop) {\n        viewportRootStyle.top = offsetTop\n      }\n\n      coordSys.setMapOffset(amapModel.__mapOffset = mapOffset)\n\n      const actionParams = {\n        type: 'amapRoam',\n        animation: {\n          // compatible with ECharts 5.x\n          // no delay for rendering but remain animation of elements\n          duration: 0\n        }\n      }\n\n      if (returnMapCameraState) {\n        e = e || {}\n        let center = e.center\n        if (!center) {\n          // normalize center LngLat to Array\n          center = amap.getCenter()\n          center = [center.lng, center.lat]\n        }\n        actionParams.camera = {\n          viewMode,\n          center,\n          zoom: e.zoom || amap.getZoom(),\n          rotation: e.rotation == null ? amap.getRotation() : e.rotation,\n          pitch: e.pitch == null ? amap.getPitch() : e.pitch,\n          scale: amap.getScale(),\n          bounds: amap.getBounds()\n        }\n      }\n\n      api.dispatchAction(actionParams)\n    }\n\n    amap.off('mapmove', this._moveHandler)\n    amap.off('moveend', this._moveHandler)\n    amap.off('viewchange', this._moveHandler)\n    amap.off('camerachange', this._moveHandler)\n    amap.off('zoom', this._moveHandler)\n\n    if (this._resizeHandler) {\n      amap.off('resize', this._resizeHandler)\n    }\n    if (this._moveStartHandler) {\n      amap.off('movestart', this._moveStartHandler)\n    }\n    if (this._moveEndHandler) {\n      amap.off('moveend', this._moveEndHandler)\n      amap.off('zoomend', this._moveEndHandler)\n    }\n\n    amap.on(\n      renderOnMoving\n        ? (_isAMap2X\n          ? 'viewchange'\n          : is3DMode\n            ? 'camerachange'\n            : 'mapmove')\n        : 'moveend',\n      // FIXME: bad performance in 1.x in the cases with large data, use debounce?\n      // moveHandler\n      (!_isAMap2X && largeMode) ? (moveHandler = throttle(moveHandler, 20, true)) : moveHandler\n    )\n\n    this._moveHandler = moveHandler\n\n    if (renderOnMoving && !(_isAMap2X && is3DMode)) {\n      // need to listen to zoom if 1.x & 2D mode\n      // FIXME: unnecessary `mapmove` event triggered when zooming\n      amap.on('zoom', moveHandler)\n    }\n\n    if (!renderOnMoving) {\n      amap.on('movestart', this._moveStartHandler = function() {\n        setTimeout(function() {\n          amapModel.setEChartsLayerVisiblity(false)\n        }, 0)\n      })\n      const moveEndHandler = this._moveEndHandler = function(e) {\n        ;(!e || e.type !== 'moveend') && moveHandler(e)\n        setTimeout(function() {\n          amapModel.setEChartsLayerVisiblity(true)\n        }, _isAMap2X || !largeMode ? 0 : 20)\n      }\n      amap.on('moveend', moveEndHandler)\n      amap.on('zoomend', moveEndHandler)\n      if (this._isFirstRender && is3DMode) {\n        // FIXME: not rewrite AMap instance method\n        const nativeSetPicth = amap.setPitch\n        const nativeSetRotation = amap.setRotation\n        amap.setPitch = function() {\n          nativeSetPicth.apply(this, arguments)\n          moveEndHandler()\n        }\n        amap.setRotation = function() {\n          nativeSetRotation.apply(this, arguments)\n          moveEndHandler()\n        }\n      }\n    }\n\n    if (resizeEnable) {\n      let resizeHandler = function() {\n        getInstanceByDom(api.getDom()).resize()\n      }\n      if (!_isAMap2X && largeMode) {\n        resizeHandler = throttle(resizeHandler, 20, true)\n      }\n      amap.on('resize', this._resizeHandler = resizeHandler)\n    }\n\n    this._isFirstRender = rendering = false\n  },\n\n  dispose(ecModel) {\n    clearLogMap()\n    const component = ecModel.getComponent('amap')\n    if (component) {\n      component.getAMap().destroy()\n      component.setAMap(null)\n      component.setEChartsLayer(null)\n      if (component.coordinateSystem) {\n        component.coordinateSystem.setAMap(null)\n        component.coordinateSystem = null\n      }\n      delete this._moveHandler\n      delete this._resizeHandler\n      delete this._moveStartHandler\n      delete this._moveEndHandler\n    }\n  }\n}\n\nexport default isV5\n  ? ComponentView.extend(AMapView)\n  : AMapView\n","/**\n * AMap component extension\n */\n\nimport AMapCoordSys from './AMapCoordSys'\nimport AMapModel from './AMapModel'\nimport AMapView from './AMapView'\nimport { isV5 } from './helper'\n\nexport { version, name } from '../package.json'\n\nexport function install(registers) {\n  // Model\n  isV5\n    ? registers.registerComponentModel(AMapModel)\n    : registers.extendComponentModel(AMapModel)\n  // View\n  isV5\n    ? registers.registerComponentView(AMapView)\n    : registers.extendComponentView(AMapView)\n  // Coordinate System\n  registers.registerCoordinateSystem('amap', AMapCoordSys)\n  // Action\n  registers.registerAction(\n    {\n      type: 'amapRoam',\n      event: 'amapRoam',\n      update: 'updateLayout'\n    },\n    function(payload, ecModel) {\n      ecModel.eachComponent('amap', function(amapModel) {\n        const amap = amapModel.getAMap()\n        const center = amap.getCenter()\n        amapModel.setCenterAndZoom([center.lng, center.lat], amap.getZoom())\n      })\n    }\n  )\n}\n","/**\r\n * TODO use `echarts/core` rather than `echarts/lib/echarts`\r\n * to avoid self-registered `CanvasRenderer` and `DataSetComponent` in Apache ECharts 5\r\n * but it's not compatible with echarts v4. Leave it to 2.0.\r\n */\r\nimport * as echarts from 'echarts/lib/echarts'\r\nimport { install } from './src/index'\r\nimport { isV5 } from './src/helper'\r\n\r\nisV5 ? echarts.use(install) : install(echarts)\r\n\r\nexport { name, version } from './src/index'\r\n"],"names":["isV5","version","split","isAMap2X","AMap","v2Equal","a","b","logMap","logWarn","tag","msg","once","log","console","warn","clearLogMap","dataToCoordSize","dataSize","dataItem","zrUtil","map","dimIdx","val","halfSize","p1","p2","Math","abs","dataToPoint","excludedOptions","AMapCoordSys","amap","api","_amap","_api","_mapOffset","AMapCoordSysProto","prototype","setZoom","zoom","_zoom","setCenter","center","lnglat","LngLat","_center","lngLatToContainer","setMapOffset","mapOffset","setAMap","getAMap","data","px","x","y","pointToData","pt","containerToLngLat","Pixel","lng","lat","getViewRect","graphic","BoundingRect","getWidth","getHeight","getRoamTransform","matrix","create","prepareCustoms","rect","coordSys","type","width","height","coord","bind","size","ecModel","amapCoordSys","eachComponent","amapModel","Error","echartsLayerInteractive","get","root","getDom","painter","getZr","viewportRoot","getViewportRoot","className","style","visibility","amapRoot","querySelector","left","top","removeChild","document","createElement","cssText","appendChild","options","clone","each","key","Map","on","setEChartsLayer","getViewportRootOffset","offsetLeft","offsetTop","oldEChartsLayerInteractive","__echartsLayerInteractive","setEChartsLayerInteractive","amapCenter","getCenter","amapZoom","getZoom","centerOrZoomChanged","setZoomAndCenter","originalMapStyle","__mapStyle","newMapStyle","setMapStyle","setLang","originalMapLang","__mapLang","newMapLang","__mapOffset","coordinateSystem","eachSeries","seriesModel","dimensions","AMapModel","__amap","layer","__echartsLayer","getEChartsLayer","setEChartsLayerVisiblity","visible","display","interactive","option","pointerEvents","setCenterAndZoom","defaultOption","isHotspot","resizeEnable","renderOnMoving","largeMode","returnMapCameraState","ComponentModel","extend","_isAMap2X","AMapView","init","_isFirstRender","render","rendering","offsetEl","getContainer","viewMode","getViewMode_","is3DMode","moveHandler","e","offsetElStyle","parseInt","viewportRootStyle","actionParams","animation","duration","camera","rotation","getRotation","pitch","getPitch","scale","getScale","bounds","getBounds","dispatchAction","off","_moveHandler","_resizeHandler","_moveStartHandler","_moveEndHandler","throttle","setTimeout","moveEndHandler","nativeSetPicth","setPitch","nativeSetRotation","setRotation","apply","arguments","resizeHandler","getInstanceByDom","resize","dispose","component","getComponent","destroy","ComponentView","install","registers","registerComponentModel","extendComponentModel","registerComponentView","extendComponentView","registerCoordinateSystem","registerAction","event","update","payload","echarts","use"],"mappings":"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"}